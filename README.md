# ИДЗ по АВС №3 / Вариант №22
## Васильев Андрей Михайлович / БПИ215

Работа выполнена с соблюдением всех критериев на **6 БАЛЛОВ**.

## Порядок действий при выполнении работы
- Написана программа на C ([main.c](https://github.com/makeitokay/avs_hw3/blob/master/main.c))
    - Используются функции с передачей данных через параметры (функция `calculatePi`)
    - Используются локальные переменные (и в функции `main`, и в `calculatePi`)
- Программа дизассемблирована ([main.s](https://github.com/makeitokay/avs_hw3/blob/master/main.s)) в GAS с помощью команды `gcc -masm=intel -fno-asynchronous-unwind-tables -fno-jump-tables -fno-stack-protector -fno-exceptions ./main.c -S -o ./main.s -lm`
- В дизассемблированной программе проведены следующие модификации:
    - Убрано все лишнее (`.file`, все после `ret` в конце, `cdqe`)
    - Произведен рефакторинг за счет использования регистров процессора (локальная переменная `int n` используется в регистре `r12`)
- В отрефакторенную и модифицированную ассемблерную программу ([main_refactored.s](https://github.com/makeitokay/avs_hw3/blob/master/main_refactored.s)) добавлены комментарии, поясняющие всю работу программы и связь с программой на C
- Программа на C и модифицированная программа на ассемблере откомпилированы для тестирования с помощью команд:
    - Компиляция `gcc ./main_refactored.s -c -o ./main.o -lm` и компоновка `gcc ./main.o -o asm_program -lm` ассемблерной программы
    - Компиляция `gcc ./main.c -o c_program -lm` программы на C
- Созданы файлы с тестовыми входными данными ([input1](https://github.com/makeitokay/avs_hw3/blob/master/input1), [input2](https://github.com/makeitokay/avs_hw3/blob/master/input2), [input3](https://github.com/makeitokay/avs_hw3/blob/master/input3))
- Тесты прогнаны, получен ожидаемый результат
- Написан этот отчет :)

## Сравнение размеров файлов

Размер файла с кодом на ассемблере до рефакторинга = **1901 байт**

Размер файла с кодом на ассемблере после рефакторинга (без комментариев) = **1446 байт**

## Результаты тестовых прогонов

Формируем файл с входными данными. Всего создано три тестовых набора:
- Первый набор проверяет общую работоспобность программы: считаем число Пи с точностью не хуже 0.01, должно получиться чуть больше 3.1315
- Второй набор проверяет точность побольше. С точностью равной 1 должно получиться число большее пи-1
- Третий набор уже проверяет довольно маленькую точность 0.005678, должно получиться число большее чем 3.1359146

Результаты тестовых прогонов можно увидеть на скриншотах: